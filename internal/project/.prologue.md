# internal/project

This package contains logic related to TiDB Cloud "projects".

It is responsible for:
- Fetching project list via the [TiDB Cloud API](https://docs.pingcap.com/tidbcloud/api/v1beta/#tag/Project/operation/ListProjects)
- Filtering and transforming project information
- Persisting project data into a MySQL-compatible database (TiDB).

## Structure

- `fetcher.go`: API client to retrieve project information
- *(planed)* `mapper.go`: convert API response into db-compatible struct
- *(planed)* `service.go`: orchestrate fetch + transform + store

## Notes

- Project IDs (`id`) and Organization IDs (`org_id`) are stored as strings to preserve compatibility with API response types.
- Data is stored in the `projects` table using upsert strategy (insert or update).
- This module assumes that project data is always synchronized to reflect the latest state, not historical snapshots.

## Related CLI Command

- `fetch-projects` (command defined in `cmd/fetch_projects.go`)

## Error Handling

- API and database errors are logged with context for easier troubleshooting.
- The command exits with a non-zero status on fatal errors to signal failure to the caller.

## Testing

- Core logic is covered by unit tests, especially for API response handling and database operations.
- Mocking is used for API and DB interactions to ensure tests are reliable and fast.
